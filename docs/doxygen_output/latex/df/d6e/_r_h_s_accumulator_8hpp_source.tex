\hypertarget{_r_h_s_accumulator_8hpp_source}{}\doxysection{RHSAccumulator.\+hpp}
\label{_r_h_s_accumulator_8hpp_source}\index{CompactStar/Physics/Evolution/RHSAccumulator.hpp@{CompactStar/Physics/Evolution/RHSAccumulator.hpp}}
\mbox{\hyperlink{_r_h_s_accumulator_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// -\/*-\/ lsst-\/c++ -\/*-\/}}
\DoxyCodeLine{2 \textcolor{comment}{/*}}
\DoxyCodeLine{3 \textcolor{comment}{ * CompactStar}}
\DoxyCodeLine{4 \textcolor{comment}{ * See License file at the top of the source tree.}}
\DoxyCodeLine{5 \textcolor{comment}{ *}}
\DoxyCodeLine{6 \textcolor{comment}{ * Copyright (c) 2025}}
\DoxyCodeLine{7 \textcolor{comment}{ * Mohammadreza Zakeri}}
\DoxyCodeLine{8 \textcolor{comment}{ *}}
\DoxyCodeLine{9 \textcolor{comment}{ * MIT License â€” see LICENSE at repo root.}}
\DoxyCodeLine{10 \textcolor{comment}{ */}}
\DoxyCodeLine{11 }
\DoxyCodeLine{35 \textcolor{preprocessor}{\#ifndef CompactStar\_Physics\_Evolution\_RHSAccumulator\_H}}
\DoxyCodeLine{36 \textcolor{preprocessor}{\#define CompactStar\_Physics\_Evolution\_RHSAccumulator\_H}}
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{preprocessor}{\#include <array>}}
\DoxyCodeLine{39 \textcolor{preprocessor}{\#include <cstddef>}}
\DoxyCodeLine{40 \textcolor{preprocessor}{\#include <stdexcept>}}
\DoxyCodeLine{41 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{42 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_tags_8hpp}{CompactStar/Physics/State/Tags.hpp}}"{}}}
\DoxyCodeLine{45 }
\DoxyCodeLine{46 \textcolor{keyword}{namespace }CompactStar::Physics::Evolution}
\DoxyCodeLine{47 \{}
\DoxyCodeLine{48 }
\DoxyCodeLine{49 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{50 \textcolor{comment}{//  RHSAccumulator}}
\DoxyCodeLine{51 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{52 }
\DoxyCodeLine{62 \textcolor{keyword}{class }\mbox{\hyperlink{class_compact_star_1_1_physics_1_1_evolution_1_1_r_h_s_accumulator}{RHSAccumulator}}}
\DoxyCodeLine{63 \{}
\DoxyCodeLine{64   \textcolor{keyword}{public}:}
\DoxyCodeLine{65     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{66     \textcolor{comment}{//  Ctors / Dtor}}
\DoxyCodeLine{67     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{68 }
\DoxyCodeLine{70     \mbox{\hyperlink{class_compact_star_1_1_physics_1_1_evolution_1_1_r_h_s_accumulator_a2969a255f1b89e8bda0bab20e6c799c1}{RHSAccumulator}}()}
\DoxyCodeLine{71     \{}
\DoxyCodeLine{72         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&b : blocks\_)}
\DoxyCodeLine{73         \{}
\DoxyCodeLine{74             b.configured = \textcolor{keyword}{false};}
\DoxyCodeLine{75         \}}
\DoxyCodeLine{76     \}}
\DoxyCodeLine{77 }
\DoxyCodeLine{79     \mbox{\hyperlink{class_compact_star_1_1_physics_1_1_evolution_1_1_r_h_s_accumulator_a7e9cb0be04da1f731601932d241fba6a}{\string~RHSAccumulator}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{80 }
\DoxyCodeLine{81     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{82     \textcolor{comment}{//  Configuration}}
\DoxyCodeLine{83     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{84 }
\DoxyCodeLine{94     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_compact_star_1_1_physics_1_1_evolution_1_1_r_h_s_accumulator_a63e5b050de3c687e57d7abca297673ad}{Configure}}(\mbox{\hyperlink{namespace_compact_star_1_1_physics_1_1_state_af14f5554b0d9be50c5ea718733bc424b}{Physics::State::StateTag}} tag, std::size\_t size)}
\DoxyCodeLine{95     \{}
\DoxyCodeLine{96         \textcolor{keyword}{auto} \&block = blocks\_[Index(tag)];}
\DoxyCodeLine{97         block.data.assign(size, 0.0);}
\DoxyCodeLine{98         block.configured = \textcolor{keyword}{true};}
\DoxyCodeLine{99     \}}
\DoxyCodeLine{100 }
\DoxyCodeLine{104     [[nodiscard]] \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_compact_star_1_1_physics_1_1_evolution_1_1_r_h_s_accumulator_afc832703bdeed29d4be9438845b0b829}{IsConfigured}}(\mbox{\hyperlink{namespace_compact_star_1_1_physics_1_1_state_af14f5554b0d9be50c5ea718733bc424b}{Physics::State::StateTag}} tag)\textcolor{keyword}{ const}}
\DoxyCodeLine{105 \textcolor{keyword}{    }\{}
\DoxyCodeLine{106         \textcolor{keywordflow}{return} blocks\_[Index(tag)].configured;}
\DoxyCodeLine{107     \}}
\DoxyCodeLine{108 }
\DoxyCodeLine{109     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{110     \textcolor{comment}{//  Accumulation}}
\DoxyCodeLine{111     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{112 }
\DoxyCodeLine{123     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_compact_star_1_1_physics_1_1_evolution_1_1_r_h_s_accumulator_af6ce1814c6bdd9961dce5b718e7d6970}{AddTo}}(\mbox{\hyperlink{namespace_compact_star_1_1_physics_1_1_state_af14f5554b0d9be50c5ea718733bc424b}{Physics::State::StateTag}} tag, std::size\_t component, \textcolor{keywordtype}{double} value)}
\DoxyCodeLine{124     \{}
\DoxyCodeLine{125         \textcolor{keyword}{auto} \&block = blocks\_[Index(tag)];}
\DoxyCodeLine{126         \textcolor{keywordflow}{if} (!block.configured)}
\DoxyCodeLine{127         \{}
\DoxyCodeLine{128             \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}RHSAccumulator::AddTo: tag '"{}} +}
\DoxyCodeLine{129                                      std::string(\mbox{\hyperlink{namespace_compact_star_1_1_physics_1_1_state_ad94b7336e81d9f83c3c7f2eb946b5e9e}{Physics::State::ToString}}(tag)) +}
\DoxyCodeLine{130                                      \textcolor{stringliteral}{"{}' not configured."{}});}
\DoxyCodeLine{131         \}}
\DoxyCodeLine{132         \textcolor{keywordflow}{if} (component >= block.data.size())}
\DoxyCodeLine{133         \{}
\DoxyCodeLine{134             \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}RHSAccumulator::AddTo: component index out of range."{}});}
\DoxyCodeLine{135         \}}
\DoxyCodeLine{136         block.data[component] += value;}
\DoxyCodeLine{137     \}}
\DoxyCodeLine{138 }
\DoxyCodeLine{145     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_compact_star_1_1_physics_1_1_evolution_1_1_r_h_s_accumulator_a2d42eb9079d699ce35b664d5d03ac117}{Clear}}()}
\DoxyCodeLine{146     \{}
\DoxyCodeLine{147         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&block : blocks\_)}
\DoxyCodeLine{148         \{}
\DoxyCodeLine{149             \textcolor{keywordflow}{if} (block.configured)}
\DoxyCodeLine{150             \{}
\DoxyCodeLine{151                 \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&v : block.data)}
\DoxyCodeLine{152                 \{}
\DoxyCodeLine{153                     v = 0.0;}
\DoxyCodeLine{154                 \}}
\DoxyCodeLine{155             \}}
\DoxyCodeLine{156         \}}
\DoxyCodeLine{157     \}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{160     \textcolor{comment}{//  Accessors}}
\DoxyCodeLine{161     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{162 }
\DoxyCodeLine{171     [[nodiscard]] \textcolor{keyword}{const} std::vector<double> \&\mbox{\hyperlink{class_compact_star_1_1_physics_1_1_evolution_1_1_r_h_s_accumulator_ab850248c73733517b68d4a82ddd25db6}{Block}}(\mbox{\hyperlink{namespace_compact_star_1_1_physics_1_1_state_af14f5554b0d9be50c5ea718733bc424b}{Physics::State::StateTag}} tag)\textcolor{keyword}{ const}}
\DoxyCodeLine{172 \textcolor{keyword}{    }\{}
\DoxyCodeLine{173         \textcolor{keyword}{const} \textcolor{keyword}{auto} \&block = blocks\_[Index(tag)];}
\DoxyCodeLine{174         \textcolor{keywordflow}{if} (!block.configured)}
\DoxyCodeLine{175         \{}
\DoxyCodeLine{176             \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}RHSAccumulator::Block(const): tag '"{}} +}
\DoxyCodeLine{177                                      std::string(\mbox{\hyperlink{namespace_compact_star_1_1_physics_1_1_state_ad94b7336e81d9f83c3c7f2eb946b5e9e}{Physics::State::ToString}}(tag)) +}
\DoxyCodeLine{178                                      \textcolor{stringliteral}{"{}' not configured."{}});}
\DoxyCodeLine{179         \}}
\DoxyCodeLine{180         \textcolor{keywordflow}{return} block.data;}
\DoxyCodeLine{181     \}}
\DoxyCodeLine{182 }
\DoxyCodeLine{191     std::vector<double> \&\mbox{\hyperlink{class_compact_star_1_1_physics_1_1_evolution_1_1_r_h_s_accumulator_ad962d2339286b8dda25323c42780666a}{Block}}(\mbox{\hyperlink{namespace_compact_star_1_1_physics_1_1_state_af14f5554b0d9be50c5ea718733bc424b}{Physics::State::StateTag}} tag)}
\DoxyCodeLine{192     \{}
\DoxyCodeLine{193         \textcolor{keyword}{auto} \&block = blocks\_[Index(tag)];}
\DoxyCodeLine{194         \textcolor{keywordflow}{if} (!block.configured)}
\DoxyCodeLine{195         \{}
\DoxyCodeLine{196             \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}RHSAccumulator::Block: tag '"{}} +}
\DoxyCodeLine{197                                      std::string(\mbox{\hyperlink{namespace_compact_star_1_1_physics_1_1_state_ad94b7336e81d9f83c3c7f2eb946b5e9e}{Physics::State::ToString}}(tag)) +}
\DoxyCodeLine{198                                      \textcolor{stringliteral}{"{}' not configured."{}});}
\DoxyCodeLine{199         \}}
\DoxyCodeLine{200         \textcolor{keywordflow}{return} block.data;}
\DoxyCodeLine{201     \}}
\DoxyCodeLine{202 }
\DoxyCodeLine{203     \textcolor{keywordtype}{double} Peek(\mbox{\hyperlink{namespace_compact_star_1_1_physics_1_1_state_af14f5554b0d9be50c5ea718733bc424b}{Physics::State::StateTag}} tag, \textcolor{keywordtype}{size\_t} i)\textcolor{keyword}{ const}}
\DoxyCodeLine{204 \textcolor{keyword}{    }\{}
\DoxyCodeLine{205         \textcolor{keyword}{const} \textcolor{keyword}{auto} \&block = blocks\_[Index(tag)];}
\DoxyCodeLine{206         \textcolor{keywordflow}{if} (!block.configured)}
\DoxyCodeLine{207         \{}
\DoxyCodeLine{208             \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}RHSAccumulator::Peek: tag '"{}} +}
\DoxyCodeLine{209                                      std::string(\mbox{\hyperlink{namespace_compact_star_1_1_physics_1_1_state_ad94b7336e81d9f83c3c7f2eb946b5e9e}{Physics::State::ToString}}(tag)) +}
\DoxyCodeLine{210                                      \textcolor{stringliteral}{"{}' not configured."{}});}
\DoxyCodeLine{211         \}}
\DoxyCodeLine{212         \textcolor{keywordflow}{if} (i >= block.data.size())}
\DoxyCodeLine{213         \{}
\DoxyCodeLine{214             \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}RHSAccumulator::Peek: component index out of range."{}});}
\DoxyCodeLine{215         \}}
\DoxyCodeLine{216         \textcolor{keywordflow}{return} block.data[i];}
\DoxyCodeLine{217     \}}
\DoxyCodeLine{218 }
\DoxyCodeLine{219   \textcolor{keyword}{private}:}
\DoxyCodeLine{220     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{221     \textcolor{comment}{//  Internal structures / helpers}}
\DoxyCodeLine{222     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{223 }
\DoxyCodeLine{224     \textcolor{comment}{// Renamed to avoid collision with Block(...) member functions.}}
\DoxyCodeLine{225     \textcolor{keyword}{struct }BlockStorage}
\DoxyCodeLine{226     \{}
\DoxyCodeLine{227         std::vector<double> data;}
\DoxyCodeLine{228         \textcolor{keywordtype}{bool} configured = \textcolor{keyword}{false};}
\DoxyCodeLine{229     \};}
\DoxyCodeLine{230 }
\DoxyCodeLine{232     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} std::size\_t NumTags =}
\DoxyCodeLine{233         \textcolor{keyword}{static\_cast<}std::size\_t\textcolor{keyword}{>}(\mbox{\hyperlink{namespace_compact_star_1_1_physics_1_1_state_af14f5554b0d9be50c5ea718733bc424ba90589c47f06eb971d548591f23c285af}{Physics::State::StateTag::Custom}}) + 1;}
\DoxyCodeLine{234 }
\DoxyCodeLine{236     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} std::size\_t Index(\mbox{\hyperlink{namespace_compact_star_1_1_physics_1_1_state_af14f5554b0d9be50c5ea718733bc424b}{Physics::State::StateTag}} tag)}
\DoxyCodeLine{237     \{}
\DoxyCodeLine{238         \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}std::size\_t\textcolor{keyword}{>}(tag);}
\DoxyCodeLine{239     \}}
\DoxyCodeLine{240 }
\DoxyCodeLine{242     std::array<BlockStorage, NumTags> blocks\_;}
\DoxyCodeLine{243 \};}
\DoxyCodeLine{244 }
\DoxyCodeLine{245 \} \textcolor{comment}{// namespace CompactStar::Physics::Evolution}}
\DoxyCodeLine{246 }
\DoxyCodeLine{247 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* CompactStar\_Physics\_Evolution\_RHSAccumulator\_H */}\textcolor{preprocessor}{}}

\end{DoxyCode}
